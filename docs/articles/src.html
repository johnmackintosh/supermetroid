<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="supermetroid">
<title>src • supermetroid</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="src">
<meta property="og:description" content="supermetroid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">supermetroid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-schema.html">data-schema</a>
    <a class="dropdown-item" href="../articles/identifying-routes.html">identifying-routes</a>
    <a class="dropdown-item" href="../articles/player-locations.html">player-locations</a>
    <a class="dropdown-item" href="../articles/player-rank.html">sio-player-rank</a>
    <a class="dropdown-item" href="../articles/route-graph.html">route-graph</a>
    <a class="dropdown-item" href="../articles/route-matching.html">route-matching</a>
    <a class="dropdown-item" href="../articles/sio.html">sio</a>
    <a class="dropdown-item" href="../articles/splits.html">splits</a>
    <a class="dropdown-item" href="../articles/src.html">src</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>src</h1>
            
      
      
      <div class="d-none name"><code>src.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># most chunks in this vignette are not evaluated because I'm not sure how to</span></span>
<span><span class="co"># save nested dictionaries yet, and calling the api borks in knitting but</span></span>
<span><span class="co"># not in console.</span></span>
<span></span>
<span><span class="co"># load R analysis package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://softloud.github.io/supermetroid/">supermetroid</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># other tools</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co"># so R can talk to Python</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a></span><span class="op">)</span></span>
<span><span class="co"># for html tables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="speedrun-com">speedrun.com<a class="anchor" aria-label="anchor" href="#speedrun-com"></a>
</h2>
<p>Speedrun.com is (according to the the two speed runners I’ve spoken
to) the canonical leaderboard for speed runners on the internet. Because
it is believed to be the most complete set (I’d like to check this with
data) of speed runs, the canonical ranking of players amongst the
community is their Speedrun.com ranking.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">src_df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/all_run_raincloud.html">all_run_raincloud</a></span><span class="op">(</span><span class="va">src_run_df</span><span class="op">)</span></span></code></pre></div>
<p><img src="src_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>The code below is how these data were extracted and cleaned for the
visualisation above.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">src_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="rdfxrqchhk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rdfxrqchhk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rdfxrqchhk thead, #rdfxrqchhk tbody, #rdfxrqchhk tfoot, #rdfxrqchhk tr, #rdfxrqchhk td, #rdfxrqchhk th {
  border-style: none;
}

#rdfxrqchhk p {
  margin: 0;
  padding: 0;
}

#rdfxrqchhk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rdfxrqchhk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rdfxrqchhk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rdfxrqchhk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rdfxrqchhk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rdfxrqchhk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdfxrqchhk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rdfxrqchhk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rdfxrqchhk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rdfxrqchhk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rdfxrqchhk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rdfxrqchhk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rdfxrqchhk .gt_spanner_row {
  border-bottom-style: hidden;
}

#rdfxrqchhk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rdfxrqchhk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rdfxrqchhk .gt_from_md > :first-child {
  margin-top: 0;
}

#rdfxrqchhk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rdfxrqchhk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rdfxrqchhk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rdfxrqchhk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rdfxrqchhk .gt_row_group_first td {
  border-top-width: 2px;
}

#rdfxrqchhk .gt_row_group_first th {
  border-top-width: 2px;
}

#rdfxrqchhk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdfxrqchhk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rdfxrqchhk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rdfxrqchhk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdfxrqchhk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdfxrqchhk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rdfxrqchhk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rdfxrqchhk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rdfxrqchhk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdfxrqchhk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rdfxrqchhk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdfxrqchhk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rdfxrqchhk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdfxrqchhk .gt_left {
  text-align: left;
}

#rdfxrqchhk .gt_center {
  text-align: center;
}

#rdfxrqchhk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rdfxrqchhk .gt_font_normal {
  font-weight: normal;
}

#rdfxrqchhk .gt_font_bold {
  font-weight: bold;
}

#rdfxrqchhk .gt_font_italic {
  font-style: italic;
}

#rdfxrqchhk .gt_super {
  font-size: 65%;
}

#rdfxrqchhk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rdfxrqchhk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rdfxrqchhk .gt_indent_1 {
  text-indent: 5px;
}

#rdfxrqchhk .gt_indent_2 {
  text-indent: 10px;
}

#rdfxrqchhk .gt_indent_3 {
  text-indent: 15px;
}

#rdfxrqchhk .gt_indent_4 {
  text-indent: 20px;
}

#rdfxrqchhk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="player_name">player_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="date">date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="t_s">t_s</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="location">location</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="player_id">player_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="run_id">run_id</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="rank" class="gt_row gt_right">1</td>
<td headers="player_name" class="gt_row gt_left">ShinyZeni</td>
<td headers="date" class="gt_row gt_right">2021-07-31</td>
<td headers="t_s" class="gt_row gt_right">4373.000</td>
<td headers="location" class="gt_row gt_left">United States</td>
<td headers="player_id" class="gt_row gt_left">zxzno3ex</td>
<td headers="run_id" class="gt_row gt_left">z5do82dm</td>
</tr>
<tr>
<td headers="rank" class="gt_row gt_right">2</td>
<td headers="player_name" class="gt_row gt_left">zoast</td>
<td headers="date" class="gt_row gt_right">2021-02-24</td>
<td headers="t_s" class="gt_row gt_right">4375.000</td>
<td headers="location" class="gt_row gt_left">Palau</td>
<td headers="player_id" class="gt_row gt_left">18v6k4nx</td>
<td headers="run_id" class="gt_row gt_left">yo75d4dm</td>
</tr>
<tr>
<td headers="rank" class="gt_row gt_right">3</td>
<td headers="player_name" class="gt_row gt_left">Behemoth87</td>
<td headers="date" class="gt_row gt_right">2021-12-08</td>
<td headers="t_s" class="gt_row gt_right">4375.930</td>
<td headers="location" class="gt_row gt_left">England</td>
<td headers="player_id" class="gt_row gt_left">zxz2wy4x</td>
<td headers="run_id" class="gt_row gt_left">m36d0q6m</td>
</tr>
<tr>
<td headers="rank" class="gt_row gt_right">4</td>
<td headers="player_name" class="gt_row gt_left">Gebbu</td>
<td headers="date" class="gt_row gt_right">2023-05-08</td>
<td headers="t_s" class="gt_row gt_right">4392.000</td>
<td headers="location" class="gt_row gt_left">Norway</td>
<td headers="player_id" class="gt_row gt_left">xk49m26j</td>
<td headers="run_id" class="gt_row gt_left">m3qo724y</td>
</tr>
<tr>
<td headers="rank" class="gt_row gt_right">5</td>
<td headers="player_name" class="gt_row gt_left">Static_Shock</td>
<td headers="date" class="gt_row gt_right">2023-06-10</td>
<td headers="t_s" class="gt_row gt_right">4438.367</td>
<td headers="location" class="gt_row gt_left">Brazil</td>
<td headers="player_id" class="gt_row gt_left">x35ve3kj</td>
<td headers="run_id" class="gt_row gt_left">m3qrx76y</td>
</tr>
<tr>
<td headers="rank" class="gt_row gt_right">6</td>
<td headers="player_name" class="gt_row gt_left">Oatsngoats</td>
<td headers="date" class="gt_row gt_right">2020-09-08</td>
<td headers="t_s" class="gt_row gt_right">4478.000</td>
<td headers="location" class="gt_row gt_left">United States</td>
<td headers="player_id" class="gt_row gt_left">zx7q0k08</td>
<td headers="run_id" class="gt_row gt_left">z1odq09m</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="api">api<a class="anchor" aria-label="anchor" href="#api"></a>
</h3>
<p>There is a Python module for accessing speedrun.com (many thanks to
maintainer…).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># this chunk is only evaluated when data is updated</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># this code from</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># https://github.com/blha303/srcomapi</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># load Python module </span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="im">import</span> srcomapi, srcomapi.datatypes <span class="im">as</span> dt</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd <span class="co"># for wrangling into df</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co"># call api</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>src_api <span class="op">=</span> srcomapi.SpeedrunCom()<span class="op">;</span> src_api.debug <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co"># It's recommended to cache the game ID and use it for future requests.</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co"># Data is cached for the current session by classname/id so future</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co"># requests for the same game are instantaneous.</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>src_api.search(srcomapi.datatypes.Game, {<span class="st">"name"</span>: <span class="st">"super metroid"</span>})</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co"># can we add a historical == true to this?</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>game <span class="op">=</span> _[<span class="dv">0</span>]</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>srcomapi_runs <span class="op">=</span> {}</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="cf">for</span> category <span class="kw">in</span> game.categories:</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">not</span> category.name <span class="kw">in</span> srcomapi_runs:</span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>    srcomapi_runs[category.name] <span class="op">=</span> {}</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>  <span class="cf">if</span> category.<span class="bu">type</span> <span class="op">==</span> <span class="st">'per-level'</span>:</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>    <span class="cf">for</span> level <span class="kw">in</span> game.levels:</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>      srcomapi_runs[category.name][level.name] <span class="op">=</span> dt.Leaderboard(src_api, data<span class="op">=</span>src_api.get(<span class="st">"leaderboards/</span><span class="sc">{}</span><span class="st">/level/</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">?embed=variables"</span>.<span class="bu">format</span>(game.<span class="bu">id</span>, level.<span class="bu">id</span>, category.<span class="bu">id</span>)))</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>    srcomapi_runs[category.name] <span class="op">=</span> dt.Leaderboard(src_api, data<span class="op">=</span>src_api.get(<span class="st">"leaderboards/</span><span class="sc">{}</span><span class="st">/category/</span><span class="sc">{}</span><span class="st">?embed=variables"</span>.<span class="bu">format</span>(game.<span class="bu">id</span>, category.<span class="bu">id</span>)))</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">### 100% Super Metroid leaderboard</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>leaderboard <span class="op">=</span> srcomapi_runs[<span class="st">'100%'</span>]</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># this chunk is only evaluated when data is updated</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># Now to inspect what I have; I'm pretty new to python, so this is a bit of an exploration.</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># this gives an error, hmm</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>leaderboard.keys()</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co"># what is leaderboard?</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="bu">type</span>(leaderboard) <span class="co"># hmm not so helpful</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co"># experimenting with what I can get out of the object</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co"># oooh leaderboard has an attribute that gives a nested dictionary</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="bu">type</span>(leaderboard.data)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co"># what else can I get out?</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>leaderboard.embeds </span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>leaderboard.category <span class="co"># returns 100%</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co"># can't seem to get much more out of leaderboard </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co"># inspect leaderboard dictionary</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>leaderboard.data.keys()</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>leaderboard.data[<span class="st">'game'</span>]</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>leaderboard.data[<span class="st">'runs'</span>]</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>src_runs <span class="op">=</span> leaderboard.data[<span class="st">'runs'</span>]</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co"># list of </span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="bu">type</span>(src_runs)</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co"># dictionaries</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="bu">type</span>(src_runs[<span class="dv">1</span>])</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co"># extracting specific values</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>src_runs[<span class="dv">0</span>].keys()</span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co"># rank</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>src_runs[<span class="dv">0</span>][<span class="st">'place'</span>]</span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="co"># run as a nested dictionary</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>src_runs[<span class="dv">0</span>][<span class="st">'run'</span>].keys()</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-dataframe">Run dataframe<a class="anchor" aria-label="anchor" href="#run-dataframe"></a>
</h3>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>src_run_df</th>
<th>description</th>
<th>from</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>date</td>
<td>timestamp of run upload</td>
<td><code>runs[index]['run']['date']</code></td>
</tr>
<tr class="even">
<td><em>run_id</em></td>
<td>unique identifier of run</td>
<td><code>runs[index]['run']['date']</code></td>
</tr>
<tr class="odd">
<td>run_time</td>
<td>total time of run in s or ms</td>
<td><code>runs[index]['run']['times']['realtime_t']</code></td>
</tr>
<tr class="even">
<td><em>player_id</em></td>
<td>unique identifier of player</td>
<td>player id == run id, debug extraction</td>
</tr>
<tr class="odd">
<td>rank</td>
<td>rank, empty if historical, currently don’t have historical obs</td>
<td><code>src_runs[x]['place']</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>n_obs <span class="op">=</span> <span class="bu">len</span>(src_runs)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># how to get splits? [src_runs][x]['run']['splits']</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># extract elements with list comprehension (new tool for me)</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>src_run_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="st">'run_id'</span> : [src_runs[x][<span class="st">'run'</span>][<span class="st">'id'</span>] <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_obs)],</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="co"># need to inspect what happens to historical ranking</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="st">'rank'</span> : [src_runs[x][<span class="st">'place'</span>] <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_obs)], </span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="st">'t_s'</span> : [src_runs[x][<span class="st">'run'</span>][<span class="st">'times'</span>][<span class="st">'realtime_t'</span>] <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_obs)],</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="st">'date'</span> : [src_runs[x][<span class="st">'run'</span>][<span class="st">'date'</span>] <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_obs)],</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="st">'player_id'</span> : [pd.DataFrame(src_runs[x][<span class="st">'run'</span>][<span class="st">'players'</span>]).iloc[<span class="dv">0</span>,<span class="dv">1</span>] </span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_obs)]</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>})</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co"># inspect runs dataframe</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>src_run_df.head()</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>src_run_df.shape</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="player-data">Player data<a class="anchor" aria-label="anchor" href="#player-data"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>layer_df</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><em>player_id</em></td>
<td>unique identifier of player</td>
</tr>
<tr class="even">
<td>player_handle</td>
<td>human-readable <strong>unique</strong> tag</td>
</tr>
<tr class="odd">
<td>location</td>
<td>geographic location of player</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># this loop fails because not all ids are valid</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># get a list of player records for each valid player id</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>src_players <span class="op">=</span> []</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="cf">for</span> player <span class="kw">in</span> <span class="bu">list</span>(src_run_df.player_id.unique()):</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"loop index"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="bu">print</span>(<span class="bu">len</span>(src_players))</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="bu">print</span>(player)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  user <span class="op">=</span> src_api.get_user(player)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  src_players.append(user)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># curiously this works on first three records but not on all</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># get a list of player records for each valid player id</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>src_players <span class="op">=</span> []</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="cf">for</span> player <span class="kw">in</span> src_run_df.player[<span class="dv">0</span>:<span class="dv">3</span>]:</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"loop index"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="bu">print</span>(<span class="bu">len</span>(src_players))</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="bu">print</span>(player)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  user <span class="op">=</span> src_api.get_user(player)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  src_players.append(user)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># not all ids work when passed to thingy</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># try-catch to identify which users' ids I can call</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>src_valid_players <span class="op">=</span> []</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>src_invalid_players <span class="op">=</span> []</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>src_users <span class="op">=</span> []</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="cf">for</span> src_player <span class="kw">in</span> <span class="bu">list</span>(src_run_df.player_id.unique()):</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="cf">try</span>: </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    user <span class="op">=</span> src_api.get_user(src_player)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    src_users.append(user)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    src_valid_players.append(src_player)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="cf">except</span>:</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>    src_invalid_players.append(src_player)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>  time.sleep(<span class="dv">3</span>)</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="bu">len</span>(src_players)</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>    </span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co"># this many records failed</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="bu">len</span>(src_invalid_players)</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co"># this many records succeeded</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="bu">len</span>(src_valid_players)</span></code></pre></div>
<div class="section level4">
<h4 id="player-dataframe">Player dataframe<a class="anchor" aria-label="anchor" href="#player-dataframe"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># extract for single</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>src_users[<span class="dv">0</span>].data[<span class="st">'id'</span>]</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># each user has an attribute that is a dictionary</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>src_users[<span class="dv">0</span>].data.keys()</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># for matching back</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>src_users[<span class="dv">1</span>].data[<span class="st">'id'</span>]</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>src_users[<span class="dv">1</span>].data[<span class="st">'names'</span>][<span class="st">'international'</span>]</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>src_users[<span class="dv">1</span>].data[<span class="st">'location'</span>][<span class="st">'country'</span>][<span class="st">'names'</span>][<span class="st">'international'</span>]</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="location-of-players-on-speedrun-com">Location of players on speedrun.com<a class="anchor" aria-label="anchor" href="#location-of-players-on-speedrun-com"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># extract list of player locations and locations separately</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>valid_player_locations <span class="op">=</span> []</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>invalid_player_locations <span class="op">=</span> []</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>player_locations <span class="op">=</span> []</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="cf">for</span> src_user <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(src_users)):</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"loop index"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="bu">print</span>(<span class="bu">len</span>(valid_player_locations) <span class="op">+</span> <span class="bu">len</span>(invalid_player_locations))</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="cf">try</span>: </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    player_location <span class="op">=</span> src_users[src_user].data[<span class="st">'location'</span>][<span class="st">'country'</span>][<span class="st">'names'</span>][<span class="st">'international'</span>]</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    valid_player_locations.append(src_user)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    player_locations.append(player_location)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>  <span class="cf">except</span>:</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>    invalid_player_locations.append(src_user)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    player_locations.append(<span class="st">"missing"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    </span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="bu">len</span>(valid_player_locations)</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="bu">len</span>(invalid_player_locations)</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="bu">len</span>(player_locations)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># extract player data into dataframe    </span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>src_player_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="st">'player_name'</span> : [src_users[x].data[<span class="st">'names'</span>][<span class="st">'international'</span>]</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(src_users))],</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="st">'location'</span> : player_locations,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="st">'player_id'</span> : [src_users[x].data[<span class="st">'id'</span>] <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(src_users))]</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>})</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>src_player_df.head()</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># join runs with player data</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>src_run_player_df <span class="op">=</span> src_player_df.merge(src_run_df, how <span class="op">=</span> <span class="st">"right"</span>, on <span class="op">=</span> <span class="st">"player_id"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># bring it over into sweet, sweet easier R</span></span>
<span><span class="va">src_df_all_obs</span> <span class="op">&lt;-</span> <span class="va">py</span><span class="op">$</span><span class="va">src_run_player_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    player_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">player_name</span><span class="op">)</span>, <span class="va">player_id</span>, <span class="va">player_name</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rank</span>, <span class="va">player_name</span>, <span class="va">date</span>, <span class="va">t_s</span>, <span class="va">location</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="visualise-runs">Visualise runs<a class="anchor" aria-label="anchor" href="#visualise-runs"></a>
</h3>
<p>Now we have the data from speedrun.com leaderboard, we can plot the
distribution of runs.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the data from python into R</span></span>
<span></span>
<span><span class="fu"><a href="../reference/all_run_raincloud.html">all_run_raincloud</a></span><span class="op">(</span><span class="va">src_df_all_obs</span><span class="op">)</span></span></code></pre></div>
<p>We have a handful of 0 entries and some &gt; 3 hours.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># how many runs are really low?</span></span>
<span><span class="va">src_df_all_obs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">t_s</span> <span class="op">&lt;</span> <span class="fl">4000</span> <span class="op">|</span> <span class="va">t_s</span> <span class="op">&gt;</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span></span></code></pre></div>
<p>The 0 entries are run times where <code>gametime</code> was captured,
but <code>realtime</code> was not by the tool the player used to record
the run. Our analyses are on <code>realtime</code>, so we will exclude
these observations.</p>
<p>We are also interest in comparing <em>speed runners</em>, as opposed
to those logging playing through the game, which takes some hours.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">prop_greater_3hrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">src_df_all_obs</span><span class="op">$</span><span class="va">t_s</span> <span class="op">&gt;</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op">/</span> </span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">src_df_all_obs</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Since only {r round(prop_greater_3hrs, 2) * 100}% of runs are greater
than 3 hours, these are negligible, and arguably not <em>speed</em>
runs. We will define a Super Metroid speed run, for this analysis, to be
a Super Metroid 100% run that takes under 3 hours.</p>
</div>
<div class="section level3">
<h3 id="raincloud">Raincloud<a class="anchor" aria-label="anchor" href="#raincloud"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">src_df_all_obs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="co"># remove 0 length runs</span></span>
<span>    <span class="va">t_s</span> <span class="op">&gt;</span> <span class="fl">0</span>, </span>
<span>    <span class="co"># exclude runs &gt; 3 hours</span></span>
<span>    <span class="va">t_s</span> <span class="op">&lt;</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="../reference/all_run_raincloud.html">all_run_raincloud</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-run-data-from-speedrun-com-to-supermetroid">Write run data from speedrun.com to supermetroid<a class="anchor" aria-label="anchor" href="#write-run-data-from-speedrun-com-to-supermetroid"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this chunk is evaluated when data is updated</span></span>
<span><span class="va">src_df</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">src_df_all_obs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># filter runs to less than 3 hours, and weird 0 length records</span></span>
<span>  <span class="co"># we won't consider these speed runs</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">t_s</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">t_s</span> <span class="op">&lt;</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">rank</span><span class="op">)</span>,</span>
<span>    player_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">player_name</span><span class="op">)</span>,</span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">use_data</a></span><span class="op">(</span><span class="va">src_df</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Charles Gray.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
